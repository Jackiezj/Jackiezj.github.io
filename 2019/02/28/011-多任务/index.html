<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>多任务 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Jackiezz, Jackiezz's Blog">
  
  <meta name="description" content="多任务 ： 操作系统可以同时运行多个任务  并发 :  任务数 &amp;gt; cpu核数, 通过操作系统任务调度算法, 实现用多个任务在同一时间段执行(事实上只有cpu核数个在执行)  并行 : 多核cpu情况下,多个任务的一些任务往往是在同一时间点执行的  在实际的场景中往往既有并发又有并行的多任务。    一、多线程线程 ：一个进程内部的一条代码执行流程(线程) ​    代码默认在默认线程上执行">
<meta property="og:type" content="article">
<meta property="og:title" content="多任务">
<meta property="og:url" content="https://www.jackiezz.com/2019/02/28/011-多任务/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="多任务 ： 操作系统可以同时运行多个任务  并发 :  任务数 &amp;gt; cpu核数, 通过操作系统任务调度算法, 实现用多个任务在同一时间段执行(事实上只有cpu核数个在执行)  并行 : 多核cpu情况下,多个任务的一些任务往往是在同一时间点执行的  在实际的场景中往往既有并发又有并行的多任务。    一、多线程线程 ：一个进程内部的一条代码执行流程(线程) ​    代码默认在默认线程上执行">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://www.jackiezz.com/2019/02/28/011-多任务/1551338580020.png">
<meta property="og:image" content="https://www.jackiezz.com/2019/02/28/011-多任务/1551348552952.png">
<meta property="og:updated_time" content="2019-03-01T15:58:20.220Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="多任务">
<meta name="twitter:description" content="多任务 ： 操作系统可以同时运行多个任务  并发 :  任务数 &amp;gt; cpu核数, 通过操作系统任务调度算法, 实现用多个任务在同一时间段执行(事实上只有cpu核数个在执行)  并行 : 多核cpu情况下,多个任务的一些任务往往是在同一时间点执行的  在实际的场景中往往既有并发又有并行的多任务。    一、多线程线程 ：一个进程内部的一条代码执行流程(线程) ​    代码默认在默认线程上执行">
<meta name="twitter:image" content="https://www.jackiezz.com/2019/02/28/011-多任务/1551338580020.png">
  
  
    <link rel="icon" href="images/favicon.ico">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>
</html>
<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">Jackiezz&#39;s Blog</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        Jackiezz&#39;s Blog
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        Jackiezz的python之路
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="MinHow" target="_blank" href="//minhow.com">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//github.com/wongminho">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="Weibo" target="_blank" href="//weibo.com/WongMinHo">
                            <i class="fa fa-weibo fa-2x"></i></a>
                    
                        <a title="Twitter" target="_blank" href="//twitter.com/huangminhow">
                            <i class="fa fa-twitter fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-011-多任务" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      多任务
    </h1>
    <div class="post-title-bar">
      <ul>
          
        <li>
          <i class="fa fa-calendar"></i>  2019-02-28
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <p>多任务 ： 操作系统可以同时运行多个任务</p>
<ul>
<li><p>并发 :  任务数 &gt; cpu核数, 通过操作系统任务调度算法, 实现用多个任务在同一时间段执行(事实上只有cpu核数个在执行)</p>
</li>
<li><p>并行 : 多核cpu情况下,多个任务的一些任务往往是在同一时间点执行的</p>
<blockquote>
<p>在实际的场景中往往既有并发又有并行的多任务。</p>
</blockquote>
</li>
</ul>
<h2 id="一、多线程"><a href="#一、多线程" class="headerlink" title="一、多线程"></a>一、多线程</h2><p>线程 ：一个进程内部的一条代码执行流程(线程)</p>
<p>​    代码默认在默认线程上执行</p>
<h3 id="1-threading模块"><a href="#1-threading模块" class="headerlink" title="1. threading模块"></a>1. threading模块</h3><blockquote>
<p>python的thread模块是比较底层的模块,python的threading模块是对thread做了一些包装的,可以更加方便的被使用</p>
</blockquote>
<ul>
<li><p><strong>函数实现多线程</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_sorry</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"I am sorry"</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        t = threading.Thread(target=say_sorry)</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure>
</li>
<li><p>程序会等待所有的子线程结束后才结束</p>
</li>
<li><p>线程数量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">threading.enumerate()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-多线程代码封装"><a href="#2-多线程代码封装" class="headerlink" title="2. 多线程代码封装"></a>2. 多线程代码封装</h3><ul>
<li><p><strong>类实现多线程</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        print(self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        t = MyThread()</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure>
<p>执行结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thread<span class="number">-3</span></span><br><span class="line">Thread<span class="number">-1</span></span><br><span class="line">Thread<span class="number">-2</span></span><br><span class="line">Thread<span class="number">-4</span></span><br><span class="line">Thread<span class="number">-5</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>线程执行顺序</p>
<p>从上面可以看出多线程程序的执行顺序是不确定的</p>
</li>
</ul>
<h3 id="3-多线程-共享全局变量"><a href="#3-多线程-共享全局变量" class="headerlink" title="3. 多线程-共享全局变量"></a>3. 多线程-共享全局变量</h3><blockquote>
<p>在一个进程内的所有线程共享全局变量,很方便在多个线程间共享数据<br>缺点 :  线程是对全局变量随意修改可能造成多线程之间对全局变量的混乱(即非线程安全)</p>
</blockquote>
<ul>
<li><p>线程不安全案例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">g_num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work1</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> g_num</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">        g_num += <span class="number">1</span></span><br><span class="line">    print(g_num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t1 = threading.Thread(target=work1, name=<span class="string">"1T"</span>, args=(<span class="number">10000000</span>,))</span><br><span class="line">    t2 = threading.Thread(target=work1, name=<span class="string">"2T"</span>, args=(<span class="number">10000000</span>,))</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br></pre></td></tr></table></figure>
</li>
<li><p>同步</p>
<p>线程同步：一个操作完成后再进行下一个操作</p>
<p>同步用互斥锁完成</p>
<blockquote>
<p>程序中的同步相当于生活中的异步， 异步相当于生活中的同步</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建锁</span></span><br><span class="line">lock = threading.Lock()</span><br><span class="line"><span class="comment"># 锁定</span></span><br><span class="line">lock.acquire()</span><br><span class="line"><span class="comment"># 释放</span></span><br><span class="line">lock.release()</span><br></pre></td></tr></table></figure>
<p>上面线程不案例的案例可以这样解决</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lock = threading.Lock()</span><br><span class="line"></span><br><span class="line">lock.acquire()</span><br><span class="line"><span class="keyword">global</span> g_num</span><br><span class="line">lock.release</span><br></pre></td></tr></table></figure>
</li>
<li><p>锁总结</p>
<ul>
<li><p>锁的好处:</p>
<ul>
<li>确保了某段关键代码只能由一个线程从头到尾完整地执行</li>
</ul>
</li>
<li><p>锁的坏处:</p>
<ul>
<li><p>阻止了多线程并发执行,包含锁的某段代码实际上只能以单线程模式执行,效率就大大地下降了</p>
</li>
<li><p>由于可以存在多个锁,不同的线程持有不同的锁,并试图获取对方持有的锁时,可能会造成死锁</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>死锁</p>
<blockquote>
<p>A锁等待B锁先释放， B锁等待A锁先释放，将造成死锁</p>
</blockquote>
<ul>
<li>避免死锁的方法<ul>
<li>程序设计时尽量避免</li>
<li>添加超时时间</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-案例：udp多线程聊天室"><a href="#4-案例：udp多线程聊天室" class="headerlink" title="4. 案例：udp多线程聊天室"></a>4. 案例：udp多线程聊天室</h3><ul>
<li><p>示例</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_msg</span><span class="params">(udp_socket)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        udp_socket.sendto(input(<span class="string">"请输入内容："</span>).encode(<span class="string">"utf-8"</span>), (<span class="string">"127.0.0.1"</span>, <span class="number">8888</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recv_msg</span><span class="params">(udp_socket)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        recv_msg = udp_socket.recvfrom(<span class="number">1024</span>)</span><br><span class="line">        print(<span class="string">"服务器返回消息："</span>+recv_msg[<span class="number">0</span>].decode(<span class="string">"utf-8"</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1.创建socket</span></span><br><span class="line">    udp_socket = socket(AF_INET, SOCK_DGRAM)</span><br><span class="line">    udp_socket.bind((<span class="string">""</span>, <span class="number">9999</span>))</span><br><span class="line">	<span class="comment"># 发送接收数据</span></span><br><span class="line">    recv_thread = threading.Thread(target=recv_msg, args=(udp_socket,))</span><br><span class="line">    recv_thread.start()</span><br><span class="line">    send_msg(udp_socket)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="二、多进程"><a href="#二、多进程" class="headerlink" title="二、多进程"></a>二、多进程</h2><h3 id="1-进程介绍"><a href="#1-进程介绍" class="headerlink" title="1. 进程介绍"></a>1. 进程介绍</h3><blockquote>
<p><strong>程序</strong> : 例如xxx.py这是程序,是一个静态的<br><strong>进程 </strong>: 一个程序运行起来后,代码+用到的资源称之为进程,它是操作系统分配资源的基本单元。</p>
</blockquote>
<p>​    <img src="/2019/02/28/011-多任务/1551338580020.png" alt="1551338580020"></p>
<ul>
<li>就绪态 : 运行的条件都已经慢去,正在等在cpu执行</li>
<li>执行态 : cpu正在执行其功能</li>
<li>等待态 : 等待某些条件满足,例如一个程序sleep了,此时就处于等待态</li>
</ul>
<h3 id="2-创建进程-multiprocessing"><a href="#2-创建进程-multiprocessing" class="headerlink" title="2. 创建进程-multiprocessing"></a>2. 创建进程-multiprocessing</h3><ul>
<li><p>函数创建子进程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_proc</span><span class="params">(name, age, **kwargs)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        p = Process(target=run_proc, args=(<span class="string">"test"</span>, <span class="number">18</span>), kwargs=&#123;<span class="string">"m"</span>: <span class="number">20</span>&#125;)</span><br><span class="line">        p.start()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-Process语法结构如下"><a href="#3-Process语法结构如下" class="headerlink" title="3. Process语法结构如下:"></a>3. Process语法结构如下:</h3><p>Process([group[,target[,name[,args[,kwargs]]]]])</p>
<ul>
<li>target:如果传递了函数的引用,可以任务这个子进程就执行这里的代码</li>
<li>args:给target指定的函数传递的参数,以元组的方式传递</li>
<li>kwargs:给target指定的函数传递命名参数</li>
<li>name:给进程设定一个名字,可以不设定</li>
<li>group:指定进程组,大多数情况下用不到</li>
</ul>
<p>Process创建的实例对象的常用方法:</p>
<ul>
<li>start():启动子进程实例(创建子进程)</li>
<li>is_alive():判断进程子进程是否还在活着</li>
<li>join([timeout]):是否等待子进程执行结束,或等待多少秒</li>
<li>terminate():不管任务是否完成,立即终止子进程</li>
</ul>
<p>Process创建的实例对象的常用属性:</p>
<ul>
<li>name:当前进程的别名,默认为Process-N,N为从1开始递增的整数</li>
<li>pid:当前进程的pid(进程号)</li>
</ul>
<h3 id="4-进程间不共享全局变量"><a href="#4-进程间不共享全局变量" class="headerlink" title="4. 进程间不共享全局变量"></a>4. 进程间不共享全局变量</h3><ul>
<li><p>示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">11</span>, <span class="number">22</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_proc</span><span class="params">()</span>:</span></span><br><span class="line">    nums.append(<span class="number">1</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(nums)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Process(target=run_proc)</span><br><span class="line">    p.start()</span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line">    p2 = Process(target=run_proc)</span><br><span class="line">    p2.start()</span><br></pre></td></tr></table></figure>
<p>结果为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">11</span>, <span class="number">22</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">11</span>, <span class="number">22</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="三、进程、线程对比"><a href="#三、进程、线程对比" class="headerlink" title="三、进程、线程对比"></a>三、进程、线程对比</h2><blockquote>
<p><strong>进程</strong> ：能够完成多任务,比如在一台电脑上能够同时运行<em>多个QQ</em><br><strong>线程</strong> ：能够完成多任务,比如一个QQ中的<em>多个聊天窗口</em></p>
</blockquote>
<ul>
<li><p><strong>定义的不同</strong></p>
<ul>
<li><p>进程 ：<strong>系统</strong>进行资源分配和调度的一个独立单位.</p>
</li>
<li><p>线程 ：是<strong>进程的一个实体</strong>,是<strong>CPU</strong>调度和分派的基本单位,它是比进程更小的能独立运行的基本单位</p>
<p>线程自己基本上不拥有系统资源,只拥有一点在运行中必不可少的资源(如程序计数器,一组寄存器和<br>栈),但是它可与同属一个进程的其他的线程共享进程所拥有的全部资源.</p>
</li>
</ul>
</li>
<li><p><strong>区别</strong></p>
<ul>
<li><p>一个程序至少有一个进程,一个进程至少有一个线程.</p>
</li>
<li><p>线程的划分尺度小于进程(资源比进程少),使得多线程程序的并发性高。</p>
</li>
<li><p>进程在执行过程中拥有独立的内存单元,而多个线程共享内存,从而极大地提高了程序的运行效率</p>
<p><img src="/2019/02/28/011-多任务/1551348552952.png" alt="1551348552952"></p>
</li>
</ul>
<blockquote>
<p>线线程不能够独立执行,必须依存在进程中<br>可以将进程理解为工厂中的一条流水线,而其中的线程就是这个流水线上的工人</p>
</blockquote>
</li>
<li><p>优缺点<br>线程和进程在使用上各有优缺点:<strong>线程执行开销小,但不利于资源的管理和保护</strong>;而<strong>进程正相反</strong>。</p>
</li>
</ul>
<h2 id="四、进程间通信"><a href="#四、进程间通信" class="headerlink" title="四、进程间通信"></a>四、进程间通信</h2><h3 id="1-Queue"><a href="#1-Queue" class="headerlink" title="1. Queue"></a>1. Queue</h3><blockquote>
<p>可以使用multiprocessing模块的Queue实现多进程之间的数据传递</p>
<p>Queue本身是一个消息列队程序</p>
</blockquote>
<ul>
<li><p>Queue的方法</p>
<ul>
<li><code>q=Queue(5)</code>  # 5为最大接收消息数量</li>
<li><code>Queue.qsize()</code> : 返回当前队列包含的消息数量;</li>
<li><code>Queue.empty()</code> : 如果队列为空,返回True,反之False;</li>
<li><code>Queue.full()</code> : 如果队列满了,返回True,反之False;</li>
<li><code>Queue.get([block[,timeout]])</code> : 获取队列中的一条消息,然后将其从列队中移除<ul>
<li>block默认值为True，无timeout时, 消息列队如果为空,此时程序将被阻塞(停在读取状态),直到从消息列队读到消息为止</li>
<li>如果设置了timeout,则会等待timeout秒,若还没读取到任何消息,则抛出”Queue.Empty”异常;</li>
<li>block值为False,消息列队如果为空,则会立刻抛出”Queue.Empty”异常;</li>
</ul>
</li>
<li><code>Queue.get_nowait()</code> : 相当Queue.get(False);</li>
<li><code>Queue.put(item,[block[,timeout]])</code> : 将item消息写入队列,block默认值为True;</li>
<li><code>Queue.put_nowait(item)</code> : 相当Queue.put(item,False);</li>
</ul>
</li>
<li><p>Queue示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line">q = Queue(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> q.full():</span><br><span class="line">    q.put_nowait(<span class="string">"info"</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">    q.get_nowait()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-Queue在进程间的通信"><a href="#2-Queue在进程间的通信" class="headerlink" title="2. Queue在进程间的通信"></a>2. Queue在进程间的通信</h3><ul>
<li><p>示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue, Process</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(q)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> q.full():</span><br><span class="line">            q.put_nowait(<span class="string">"info"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(q)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">            print(q.get_nowait())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1.父进程创建Queue并传给子进程</span></span><br><span class="line">    q = Queue(<span class="number">3</span>)  <span class="comment"># type:Queue</span></span><br><span class="line">    pw = Process(target=write, args=(q,))</span><br><span class="line">    pr = Process(target=read, args=(q,))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.写入的子进程写入数据</span></span><br><span class="line">    pw.start()</span><br><span class="line">    pw.join()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.读取的子进程读取数据</span></span><br><span class="line">    pr.start()</span><br><span class="line">    pr.join()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4.结束</span></span><br><span class="line">    print(<span class="string">"over"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="五、进程池Pool"><a href="#五、进程池Pool" class="headerlink" title="五、进程池Pool"></a>五、进程池Pool</h2><blockquote>
<p>multiprocessing中的Pool方法一次性动态成生多个进程</p>
</blockquote>
<ul>
<li><strong>Pool(5)</strong><ul>
<li>初始化5个进程</li>
<li>新请求提交到Pool时，若Pool没满，创建新进程执行该请求</li>
<li>若Pool已达最大值，请求等待，直到池中有进程结束，才会用之前的进程来执行新的任务</li>
</ul>
</li>
<li><p><strong>multiprocessing.Pool常用函数解析</strong></p>
<ul>
<li><code>apply_async(func[,args[,kwds]])</code> : 使用非阻塞方式调用func(并行执行,堵塞方式必须等待上一个进程退出才能执行下一个进程),args为传递给func的参数列表,kwds为传递给func的关键字参数列表;</li>
<li><code>close()</code> : 关闭Pool,使其不再接受新的任务;</li>
<li><code>terminate()</code> : 不管任务是否完成,立即终止;</li>
<li><code>join()</code> : 主进程阻塞,等待子进程的退出, 必须在close或terminate之后使用;</li>
</ul>
</li>
<li><p><strong>示例</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">po = Pool(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    po.apply_async(work, (i,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">po.close()  <span class="comment"># 关闭进程池,关闭后po不再接收新的请求</span></span><br><span class="line">po.join()  <span class="comment"># 等待po中所有子进程执行完成,必须放在close语句之后</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>进程池中的Queue</strong></p>
<blockquote>
<p>使用Pool创建进程，使用multiprocessing.Manager()中的Queue()，而不是multiprocessing.Queue()</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Manager</span><br><span class="line">Manager().Queue(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="案例：copy功能"><a href="#案例：copy功能" class="headerlink" title="案例：copy功能"></a>案例：copy功能</h3><ul>
<li><p>示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">copy_file</span><span class="params">(file_path, new_dir_path, q)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> os.path.isdir(file_path):</span><br><span class="line">        os.mkdir(new_dir_path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        content = <span class="keyword">None</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> open(file_path, <span class="string">"rb"</span>) <span class="keyword">as</span> fr:</span><br><span class="line">                content = fr.read()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> open(new_dir_path, <span class="string">"wb"</span>) <span class="keyword">as</span> fw:</span><br><span class="line">                fw.write(content)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> q.full():</span><br><span class="line">        q.put_nowait(file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_path_list = []</span><br><span class="line">dir_path_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_file_path</span><span class="params">(path)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> os.path.isfile(path):</span><br><span class="line">        file_path_list.append(path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dir_path_list.append(path)</span><br><span class="line">        path_list = os.listdir(path)</span><br><span class="line">        <span class="keyword">for</span> new_path <span class="keyword">in</span> path_list:</span><br><span class="line">            get_file_path(path + <span class="string">"/"</span> + new_path)</span><br><span class="line">    <span class="keyword">return</span> file_path_list, dir_path_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 消息对列用于显示进度</span></span><br><span class="line">    q = Queue(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1.获取copy的文件夹</span></span><br><span class="line">    dir_path = input(<span class="string">"请输入要copy的文件夹绝对路径："</span>)</span><br><span class="line">    dir_path_back = dir_path + <span class="string">"[backup]"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.递归取出每个空文件夹及文件路径</span></span><br><span class="line">    get_file_path(dir_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.分别copy文件及空文件夹  到  新的文件夹</span></span><br><span class="line">    <span class="keyword">for</span> empty_file_path <span class="keyword">in</span> dir_path_list:</span><br><span class="line">        new_dir_path = dir_path_back + empty_file_path[dir_path_back.find(<span class="string">"["</span>):]</span><br><span class="line">        copy_file(empty_file_path, new_dir_path, q)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> file_path <span class="keyword">in</span> file_path_list:</span><br><span class="line">        <span class="comment"># /home/test[back]  /home/test/t.txt  --&gt; /home/test[back]/t.txt</span></span><br><span class="line">        new_dir_path = dir_path_back + file_path[dir_path_back.find(<span class="string">"["</span>):]</span><br><span class="line">        <span class="comment"># copy_file(file_path, new_dir_path, q)</span></span><br><span class="line">        p = Process(target=copy_file, args=(file_path, new_dir_path, q))</span><br><span class="line">        p.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4.显示进度</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    sum = len(file_path_list) + len(dir_path_list)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> q.empty():</span><br><span class="line">            q.get_nowait()</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        print(<span class="string">"进度为%.2f%%"</span> % (count/sum*<span class="number">100</span>))</span><br><span class="line">        <span class="keyword">if</span> count/sum == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="六、迭代器"><a href="#六、迭代器" class="headerlink" title="六、迭代器"></a>六、迭代器</h2><h3 id="1-可迭代对象"><a href="#1-可迭代对象" class="headerlink" title="1. 可迭代对象"></a>1. 可迭代对象</h3><ul>
<li><p><strong>可迭代对象</strong></p>
<blockquote>
<p><strong>可迭代对象(Iterable)</strong> ：可以通过for…in…这类语句迭代读取一条数据供我们使用的对象</p>
</blockquote>
</li>
<li><p><strong>如何判断一个对象是否可以迭代</strong></p>
<p><code>isinstance()</code>判断一个对象是否是Iterable对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可迭代对象有：[], (), &#123;&#125;, "abc"</span></span><br><span class="line">isinstance(&#123;&#125;, Iterable)  <span class="comment"># 判断一个对象是否是可迭代对象</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>可迭代对象的本质</strong></p>
<ul>
<li><strong>迭代器</strong>：每迭代一次，for…in…都返回下一条数据，在这个过程中就应该有一个“人”去记录每次访问到了第几条数据，我们把这个“人”称为迭代器(Iterator)。</li>
<li><strong>可迭代对象的本质</strong> ：可以向我们提供一个这样的中间“人”即迭代器帮我们对其进行迭代遍历</li>
<li><strong>可迭代对象的实现</strong> ：通过 <code>__iter__</code>方法向我们提供一个迭代器，那么也就是说,一个具备<code>__iter__</code>     方法的对象,就是一个可迭代对象。</li>
</ul>
</li>
<li><p><strong>可迭代对象的实现</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyList</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.container = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, item)</span>:</span></span><br><span class="line">        self.container.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">my_list = MyList()</span><br><span class="line">print(isinstance(my_list, Iterable))  <span class="comment"># True</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-迭代器"><a href="#2-迭代器" class="headerlink" title="2. 迭代器"></a>2. 迭代器</h3><blockquote>
<p>一个实现了 <code>__iter__</code>方法和<code>__next__</code> 方法的对象,就是迭代器。</p>
</blockquote>
<p><strong>迭代器</strong>  :  帮助记录每次迭代访问到的位置，当我们对迭代器使用next()函数的时候，迭代器会向我们返回它所记录位置的下一个位置的数据。</p>
<p><strong>实际上</strong> ，在使用next()函数的时候,调用的就是迭代器对象的 <code>__next__</code> 方法(Python3中是对象的 <code>__next__</code>方法,Python2中是对象的next()方法)</p>
<p><strong>构造一个迭代器</strong> ， 就要实现它的<code>__next__</code>方法。python要求迭代器本身也是可迭代的,所以我们还要为迭代器实现 <code>__iter__</code>方法，,而 <code>__iter__</code> 方法要返回一个迭代器,迭代器自身正是一个迭代器,所以迭代器的 <code>__iter__</code>方法返回自身即可。</p>
<ul>
<li><p><strong>iter()</strong></p>
<blockquote>
<p>iter()函数可获取可迭代对象的迭代器</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterator</span><br><span class="line"></span><br><span class="line">print(isinstance([], Iterator))  <span class="comment"># False</span></span><br><span class="line">print(isinstance(iter([]), Iterator))  <span class="comment"># True</span></span><br><span class="line">print(isinstance(iter(<span class="string">"abc"</span>), Iterator))  <span class="comment"># True</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>next()</strong></p>
<blockquote>
<p>对获取到的<strong>迭代器</strong>不断使用next()获取下一条数据</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list_iter = iter([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">next(list_iter)</span><br><span class="line"><span class="comment"># 当next取不到数据时，抛出StopIteration异常</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-for-…-in-…-本质"><a href="#3-for-…-in-…-本质" class="headerlink" title="3. for … in … 本质"></a>3. for … in … 本质</h3><blockquote>
<p>iter()  –获取–&gt; 可迭代对象Iterable的迭代器 –&gt; next()获取值赋给item –&gt; 异常StopIteration结束循环</p>
</blockquote>
<h3 id="4-应用"><a href="#4-应用" class="headerlink" title="4. 应用"></a>4. 应用</h3><blockquote>
<p>迭代器通过next()函数的调用来返回下一个数据值  –&gt;  不用再将所有要迭代的数据都一次性缓存下来供后续依次读取,这样可以节省大量的存储(内存)空间</p>
</blockquote>
<ul>
<li><p>示例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FibIterator</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        self.current = <span class="number">0</span></span><br><span class="line">        self.num1 = <span class="number">0</span></span><br><span class="line">        self.num2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.current &lt; self.n:</span><br><span class="line">            self.num1, self.num2 = self.num2, self.num1+self.num2</span><br><span class="line">            self.current += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> self.num1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fib = FibIterator(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> fib:</span><br><span class="line">    print(num, end=<span class="string">" "</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="七、生成器"><a href="#七、生成器" class="headerlink" title="七、生成器"></a>七、生成器</h2><h3 id="1-生成器介绍"><a href="#1-生成器介绍" class="headerlink" title="1. 生成器介绍"></a>1. 生成器介绍</h3><p><strong>生成器是一类特殊的迭代器</strong></p>
<p>利用迭代器可以在每次迭代获取数据(通过next()方法)时按照特定的规律进行生成.</p>
<p>但是我们在实现一个迭代器时,关于当前迭代到的状态需要我们自己记录,进而才能根据当前状态生成下一个数据</p>
<p>为了达到记录当前状态,并配合next()函数进行迭代使用,我们可以采用更简便的语法,即生成器(generator)</p>
<h3 id="2-创建生成器"><a href="#2-创建生成器" class="headerlink" title="2. 创建生成器"></a>2. 创建生成器</h3><ul>
<li><p>[] –&gt; ()  : 把一个列表生成式的[]改成()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G = (x*<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>对于生成器G, 可以按照迭代器的使用方法来使用,即可以通过next()函数、for循环、list()等方法使用。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">next(G)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> G:</span><br><span class="line">    print(x)</span><br></pre></td></tr></table></figure>
</li>
<li><p>方法二：yield</p>
<blockquote>
<p>只要在def中有yield关键字的就称为生成器</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></span><br><span class="line">    current = <span class="number">0</span></span><br><span class="line">    num1, num2 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> current &lt; n:</span><br><span class="line">        num = num1</span><br><span class="line">        num1, num2 = num2, num1 + num2</span><br><span class="line">        current += <span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span> num  <span class="comment"># yield使fib函数成为一个生成器而不再是一个函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"done"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">F = fib(<span class="number">5</span>)</span><br><span class="line">print(next(F))</span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> F:</span><br><span class="line">    print(f)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>获取生成器中return的值</strong></p>
<p>返回值包含在StopIteration的value中</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">F = fib(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = next(F)</span><br><span class="line">    <span class="keyword">except</span> StopIteration <span class="keyword">as</span> e:</span><br><span class="line">        print(e.value)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-使用send方法"><a href="#3-使用send方法" class="headerlink" title="3. 使用send方法"></a>3. 使用send方法</h3><ul>
<li><p>send唤醒生成器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">temp = <span class="keyword">yield</span> num</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">next(F)  <span class="comment"># next(F) 等价于 F.send(None)</span></span><br><span class="line">F.send(<span class="string">"python"</span>)  <span class="comment"># 此时的temp就为"python"</span></span><br><span class="line"><span class="comment"># 正确的解释是next和send函数在执行完yield后暂停执行(断点)，即将生成器函数挂起。并将yield后的值返回</span></span><br><span class="line"><span class="comment"># 使用send时在断点处传入一个“附加数据”，temp用来接收这个附加数据</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="八、协程"><a href="#八、协程" class="headerlink" title="八、协程"></a>八、协程</h2><h3 id="1-协程介绍"><a href="#1-协程介绍" class="headerlink" title="1. 协程介绍"></a>1. 协程介绍</h3><ul>
<li><p>协程,又称微线程,纤程</p>
</li>
<li><p>它是一个自带CPU上下文的执行单元</p>
</li>
<li><p>例如： 可以在任何地方保存当前函数的一些临时变量等信息,然后切换到另外一个函数中执行并且切换次数及时机由开发者确定</p>
</li>
<li><p><strong>协程和线程差异</strong><br>线程切换从系统层面远不止保存和恢复CPU上下文这么简单。操作系统为了程序运行的高效性每个线程都有自己缓存Cache等等数据,操作系统还会帮你做这些数据的恢复操作。所以线程的切换非常耗性能。</p>
<p>但是协程的切换只是单纯的操作CPU的上下文,所以一秒钟切换个上百万次系统都抗的住。</p>
</li>
</ul>
<h3 id="2-协程的实现"><a href="#2-协程的实现" class="headerlink" title="2. 协程的实现"></a>2. 协程的实现</h3><ul>
<li><p><strong>协程的简单实现</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consumer</span><span class="params">()</span>:</span></span><br><span class="line">    r = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        n = <span class="keyword">yield</span> r</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> n:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        print(<span class="string">'[CONSUMER] Consuming %s...'</span> % n)</span><br><span class="line">        r = <span class="string">'200 OK'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">produce</span><span class="params">(c)</span>:</span></span><br><span class="line">    c.send(<span class="keyword">None</span>)</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="number">5</span>:</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">        print(<span class="string">'[PRODUCER] Producing %s...'</span> % n)</span><br><span class="line">        r = c.send(n)</span><br><span class="line">        print(<span class="string">'[PRODUCER] Consumer return: %s'</span> % r)</span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">c = consumer()</span><br><span class="line">produce(c)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用yield实现协程</p>
<p><strong>传统的生产者-消费者模型</strong>是一个线程写消息，一个线程取消息，通过锁机制控制队列和等待，但一不小心就可能死锁</p>
<p><strong>协程生产消费模型</strong>生产者生产消息后，直接通过<code>yield</code>跳转到消费者开始执行，待消费者执行完毕后，切换回生产者继续生产，效率极高</p>
</blockquote>
</li>
<li><p><strong>gevent</strong></p>
<blockquote>
<p>其原理是当一个greenlet遇到IO操作时,比如访问网络,就自动切换到其他的greenlet,等到IO操作完成,再在适当的时候切换回来继续执行。<br>由于IO操作非常耗时,经常使程序处于等待状态,有了gevent为我们自动切换协程,就保证总有greenlet在运行,而不是等待IO</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install gevent</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        print(gevent.getcurrent(), i)</span><br><span class="line">        gevent.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g1 = gevent.spawn(f, <span class="number">2</span>)</span><br><span class="line">g2 = gevent.spawn(f, <span class="number">2</span>)</span><br><span class="line">g1.join()</span><br><span class="line">g2.join()</span><br><span class="line"><span class="comment"># 运行结果为</span></span><br><span class="line">&lt;Greenlet at <span class="number">0x7fc4eca68448</span>: f(<span class="number">5</span>)&gt; <span class="number">0</span></span><br><span class="line">&lt;Greenlet at <span class="number">0x7fc4eca68648</span>: f(<span class="number">5</span>)&gt; <span class="number">0</span></span><br><span class="line">&lt;Greenlet at <span class="number">0x7fc4eca68448</span>: f(<span class="number">5</span>)&gt; <span class="number">1</span></span><br><span class="line">&lt;Greenlet at <span class="number">0x7fc4eca68648</span>: f(<span class="number">5</span>)&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-给程序打补丁"><a href="#3-给程序打补丁" class="headerlink" title="3. 给程序打补丁"></a>3. 给程序打补丁</h3><ul>
<li><p>示例</p>
<blockquote>
<p>将程序中用到的耗时操作的代码,换为gevent中自己实现的模块</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> monkey</span><br><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"></span><br><span class="line">monkey.patch_all()  <span class="comment"># 猴子补丁</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">(work_name)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        time.sleep(random.random())</span><br><span class="line">        print(work_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gevent.joinall([</span><br><span class="line">    gevent.spawn(work, <span class="string">"work1"</span>),</span><br><span class="line">    gevent.spawn(work, <span class="string">"work2"</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="4-进程、线程、协程总结"><a href="#4-进程、线程、协程总结" class="headerlink" title="4. 进程、线程、协程总结"></a>4. 进程、线程、协程总结</h3><ol>
<li>进程是资源分配的单位</li>
<li>线程是操作系统调度的单位</li>
<li>进程切换需要的资源很最大,效率很低</li>
<li>线程切换需要的资源一般,效率一般</li>
<li>协程切换任务资源很小,效率高</li>
<li>多进程、多线程根据cpu核数不一样可能是并行的也可能是并发的。协程的本质就是使用当前进程， 在不同的函数代码中切换执行,可以理解为并行。协程是一个用户层面的概念,不同协程的模型实现可能是单线程也可能是多线程。</li>
</ol>

            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2019年03月01日 23:58</p>
        <p>原始链接： <a class="post-url" href="/2019/02/28/011-多任务/" title="多任务">https://www.jackiezz.com/2019/02/28/011-多任务/</a></p>
        <footer>
            <a href="https://www.jackiezz.com">
                <img src="/images/logo.png" alt="John Doe">
                John Doe
            </a>
        </footer>
    </div>
</div>

      
        
            
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;">赏</a>
</div>

<div id="reward" class="post-modal reward-lay">
    <a class="close" href="javascript:;" id="reward-close">×</a>
    <span class="reward-title">
        <i class="icon icon-quote-left"></i>
        请我吃糖~
        <i class="icon icon-quote-right"></i>
    </span>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/images/wechat_code.jpg" alt="打赏二维码">
        </div>
        <div class="reward-select">
            
            <label class="reward-select-item checked" data-id="wechat" data-wechat="/images/wechat_code.jpg">
                <img class="reward-select-item-wechat" src="/images/wechat.png" alt="微信">
            </label>
            
            
            <label class="reward-select-item" data-id="alipay" data-alipay="/images/alipay_code.jpg">
                <img class="reward-select-item-alipay" src="/images/alipay.png" alt="支付宝">
            </label>
            
        </div>
    </div>
</div>


        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://www.jackiezz.com/2019/02/28/011-多任务/&title=《多任务》 — Hexo&pic=https://www.jackiezz.comimages/logo.png" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://www.jackiezz.com/2019/02/28/011-多任务/&title=《多任务》 — Hexo&source=" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://www.jackiezz.com/2019/02/28/011-多任务/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《多任务》 — Hexo&url=https://www.jackiezz.com/2019/02/28/011-多任务/&via=https://www.jackiezz.com" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://www.jackiezz.com/2019/02/28/011-多任务/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://www.jackiezz.com/2019/02/28/011-多任务/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一、多线程"><span class="post-toc-text">一、多线程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-threading模块"><span class="post-toc-text">1. threading模块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-多线程代码封装"><span class="post-toc-text">2. 多线程代码封装</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-多线程-共享全局变量"><span class="post-toc-text">3. 多线程-共享全局变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-案例：udp多线程聊天室"><span class="post-toc-text">4. 案例：udp多线程聊天室</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二、多进程"><span class="post-toc-text">二、多进程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-进程介绍"><span class="post-toc-text">1. 进程介绍</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-创建进程-multiprocessing"><span class="post-toc-text">2. 创建进程-multiprocessing</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-Process语法结构如下"><span class="post-toc-text">3. Process语法结构如下:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-进程间不共享全局变量"><span class="post-toc-text">4. 进程间不共享全局变量</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三、进程、线程对比"><span class="post-toc-text">三、进程、线程对比</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四、进程间通信"><span class="post-toc-text">四、进程间通信</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-Queue"><span class="post-toc-text">1. Queue</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-Queue在进程间的通信"><span class="post-toc-text">2. Queue在进程间的通信</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#五、进程池Pool"><span class="post-toc-text">五、进程池Pool</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#案例：copy功能"><span class="post-toc-text">案例：copy功能</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#六、迭代器"><span class="post-toc-text">六、迭代器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-可迭代对象"><span class="post-toc-text">1. 可迭代对象</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-迭代器"><span class="post-toc-text">2. 迭代器</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-for-…-in-…-本质"><span class="post-toc-text">3. for … in … 本质</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-应用"><span class="post-toc-text">4. 应用</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#七、生成器"><span class="post-toc-text">七、生成器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-生成器介绍"><span class="post-toc-text">1. 生成器介绍</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-创建生成器"><span class="post-toc-text">2. 创建生成器</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-使用send方法"><span class="post-toc-text">3. 使用send方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#八、协程"><span class="post-toc-text">八、协程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-协程介绍"><span class="post-toc-text">1. 协程介绍</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-协程的实现"><span class="post-toc-text">2. 协程的实现</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-给程序打补丁"><span class="post-toc-text">3. 给程序打补丁</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-进程、线程、协程总结"><span class="post-toc-text">4. 进程、线程、协程总结</span></a></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2019/03/01/012-Vue/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          Vue.js
        
      </span>
    </a>
  
  
    <a href="/2019/02/27/009-VI/" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">VI</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>



    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2019 John Doe<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "https://www.jackiezz.com",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Database/">Database</a><a class="category-link" href="/categories/Markdown/">Markdown</a><a class="category-link" href="/categories/前端/">前端</a><a class="category-link" href="/categories/博客/">博客</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/Flask/" style="font-size: 20px;">Flask</a> <a href="/tags/HTML-CSS/" style="font-size: 20px;">HTML&CSS</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/Flask/" style="font-size: 20px;">Flask</a> <a href="/tags/HTML-CSS/" style="font-size: 20px;">HTML&CSS</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
</body>
</html>